
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DriftBuddy Security Report</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
            }
            
            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }
            
            .header {
                background: white;
                border-radius: 15px;
                padding: 30px;
                margin-bottom: 30px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                text-align: center;
            }
            
            .header h1 {
                color: #2c3e50;
                font-size: 2.5em;
                margin-bottom: 10px;
            }
            
            .header .subtitle {
                color: #7f8c8d;
                font-size: 1.1em;
            }
            
            .summary-section {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }
            
            .summary-card {
                background: white;
                border-radius: 15px;
                padding: 25px;
                text-align: center;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                transition: transform 0.3s ease;
            }
            
            .summary-card:hover {
                transform: translateY(-5px);
            }
            
            .summary-number {
                font-size: 2.5em;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .summary-label {
                font-size: 1.1em;
                font-weight: 500;
            }
            
            .summary-card.critical {
                border-left: 5px solid #e74c3c;
            }
            .summary-card.critical .summary-number {
                color: #e74c3c;
            }
            
            .summary-card.high {
                border-left: 5px solid #f39c12;
            }
            .summary-card.high .summary-number {
                color: #f39c12;
            }
            
            .summary-card.medium {
                border-left: 5px solid #3498db;
            }
            .summary-card.medium .summary-number {
                color: #3498db;
            }
            
            .summary-card.low {
                border-left: 5px solid #27ae60;
            }
            .summary-card.low .summary-number {
                color: #27ae60;
            }
            
            .summary-card.info {
                border-left: 5px solid #95a5a6;
            }
            .summary-card.info .summary-number {
                color: #95a5a6;
            }
            
            .toc {
                background: white;
                border-radius: 15px;
                padding: 25px;
                margin-bottom: 30px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                position: sticky;
                top: 20px;
                z-index: 100;
            }
            
            .toc h3 {
                color: #2c3e50;
                margin-bottom: 15px;
            }
            
            .toc ul {
                list-style: none;
            }
            
            .toc li {
                margin-bottom: 8px;
            }
            
            .toc a {
                color: #3498db;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.3s ease;
            }
            
            .toc a:hover {
                color: #2980b9;
            }
            
            .severity-section {
                margin-bottom: 40px;
            }
            
            .severity-header {
                background: white;
                border-radius: 15px 15px 0 0;
                padding: 20px 25px;
                margin-bottom: 0;
                font-size: 1.5em;
                font-weight: 600;
            }
            
            .severity-header.critical {
                background: linear-gradient(135deg, #e74c3c, #c0392b);
                color: white;
            }
            
            .severity-header.high {
                background: linear-gradient(135deg, #f39c12, #e67e22);
                color: white;
            }
            
            .severity-header.medium {
                background: linear-gradient(135deg, #3498db, #2980b9);
                color: white;
            }
            
            .severity-header.low {
                background: linear-gradient(135deg, #27ae60, #229954);
                color: white;
            }
            
            .severity-header.info {
                background: linear-gradient(135deg, #95a5a6, #7f8c8d);
                color: white;
            }
            
            .finding-card {
                background: white;
                border-radius: 0 0 15px 15px;
                margin-bottom: 20px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                overflow: hidden;
            }
            
            .finding-header {
                padding: 20px 25px;
                border-bottom: 1px solid #ecf0f1;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            .severity-badge {
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 0.8em;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .severity-badge.critical {
                background: #e74c3c;
                color: white;
            }
            
            .severity-badge.high {
                background: #f39c12;
                color: white;
            }
            
            .severity-badge.medium {
                background: #3498db;
                color: white;
            }
            
            .severity-badge.low {
                background: #27ae60;
                color: white;
            }
            
            .severity-badge.info {
                background: #95a5a6;
                color: white;
            }
            
            .finding-title {
                color: #2c3e50;
                font-size: 1.3em;
                margin: 0;
            }
            
            .finding-details {
                padding: 20px 25px;
                background: #f8f9fa;
            }
            
            .detail-item {
                margin-bottom: 10px;
            }
            
            .detail-item:last-child {
                margin-bottom: 0;
            }
            
            .detail-item code {
                background: #e9ecef;
                padding: 2px 6px;
                border-radius: 4px;
                font-family: 'Courier New', monospace;
            }
            
            .finding-explanation {
                padding: 20px 25px;
            }
            
            .finding-explanation h4 {
                color: #2c3e50;
                margin-bottom: 15px;
                font-size: 1.1em;
            }
            
            .explanation-content {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 8px;
                border-left: 4px solid #3498db;
                line-height: 1.7;
            }
            
            .finding-footer {
                padding: 15px 25px;
                background: #f8f9fa;
                border-top: 1px solid #ecf0f1;
            }
            
            .learn-more-btn {
                display: inline-block;
                background: #3498db;
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                text-decoration: none;
                font-weight: 500;
                transition: background 0.3s ease;
            }
            
            .learn-more-btn:hover {
                background: #2980b9;
            }
            
            .footer {
                text-align: center;
                padding: 30px;
                color: white;
                font-size: 0.9em;
            }
            
            @media (max-width: 768px) {
                .container {
                    padding: 10px;
                }
                
                .header h1 {
                    font-size: 2em;
                }
                
                .summary-section {
                    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                }
                
                .finding-header {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 10px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üõ°Ô∏è DriftBuddy Security Report</h1>
                <p class="subtitle">Infrastructure as Code Security Analysis Dashboard</p>
                <p class="subtitle">Generated on 2025-07-25 22:01:02</p>
            </div>
            
            <div class="summary-section">
                
            <div class="summary-card critical">
                <div class="summary-number">1</div>
                <div class="summary-label">CRITICAL</div>
            </div>
            
            <div class="summary-card medium">
                <div class="summary-number">2</div>
                <div class="summary-label">MEDIUM</div>
            </div>
            
            <div class="summary-card low">
                <div class="summary-number">1</div>
                <div class="summary-label">LOW</div>
            </div>
            
            </div>
            
            
        <div class="toc">
            <h3>üìã Table of Contents</h3>
            <ul>
        <li><a href="#critical-section">CRITICAL (1)</a></li><li><a href="#medium-section">MEDIUM (2)</a></li><li><a href="#low-section">LOW (1)</a></li></ul></div>
            
            <div class="findings-content">
                <div id="critical-section" class="severity-section"><h2 class="severity-header critical">CRITICAL (1)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge critical">CRITICAL</span>
                        <h3 class="finding-title">S3 Bucket ACL Allows Read Or Write to All Users</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>3</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> S3 Buckets should not be readable and writable to all users
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            1. Explanation:<br>The issue indicates that an Amazon S3 bucket in your Infrastructure as Code (IaC) configuration, specifically in the file `main.tf` at line 3, has been configured to allow read and write access to all users. This means anyone, regardless of whether they are authorized or not, can read data from or write data to this S3 bucket.<br><br>2. Security Concern:<br>This is a critical security concern because it exposes your data to potential unauthorized access, data theft, or data manipulation. Sensitive information could be read by malicious actors, or they could upload harmful content to your bucket.<br><br>3. Code Fix:<br>Assuming you are using Terraform, you can fix this issue by restricting the access to the S3 bucket. Here is an example of how to do it:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "bucket-name"<br>  acl    = "private"<br><br>  versioning {<br>    enabled = true<br>  }<br>}<br>```<br>In this example, the `acl` property is set to `private`, which means the bucket is not publicly accessible.<br><br>4. Best Practices:<br>To prevent this issue in the future, follow these best practices:<br><br>   - Always set your S3 buckets to private unless there is a specific need for them to be public.<br>   <br>   - Regularly review your bucket permissions to ensure they are set correctly.<br>   <br>   - Use IAM roles and policies to control access to your buckets. Only give the necessary permissions to those who need it.<br>   <br>   - Enable versioning on your S3 buckets to keep track of and easily roll back any unwanted changes.<br>   <br>   - Use tools to automatically check your IaC for security issues. This can help catch and fix problems before they become serious security risks.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div><div id="medium-section" class="severity-section"><h2 class="severity-header medium">MEDIUM (2)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge medium">MEDIUM</span>
                        <h3 class="finding-title">S3 Bucket Logging Disabled</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            1. Explanation: This security issue means that the S3 bucket in your Infrastructure as Code (IaC) setup does not have server access logging enabled. Server access logging is a feature that records all requests made to a specified S3 bucket. Without it, you won't have a record of who accessed your bucket and what actions they performed.<br><br>2. Security Concern: This is a security concern because without logging, malicious activity such as unauthorized access, data manipulation, or data theft could occur without detection. Logging provides an audit trail that can be used to identify and investigate suspicious activity.<br><br>3. Secure Code Example: To fix this issue, you need to enable server access logging for your S3 bucket in your Terraform file. Here's an example:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "my-bucket"<br>  acl    = "private"<br><br>  logging {<br>    target_bucket = "${aws_s3_bucket.log_bucket.id}"<br>    target_prefix = "log/"<br>  }<br>}<br><br>resource "aws_s3_bucket" "log_bucket" {<br>  bucket = "my-log-bucket"<br>  acl    = "log-delivery-write"<br>}<br>```<br>In this example, all access logs for 'my-bucket' will be stored in 'my-log-bucket' under the 'log/' prefix.<br><br>4. Best Practices: To prevent this issue, always enable server access logging for your S3 buckets. Make it a standard part of your IaC setup. Regularly review your logs for any suspicious activity. Also, consider using automated tools to monitor and alert on unusual activity. Lastly, restrict access to your S3 buckets using appropriate IAM policies and ensure that only authorized users have access.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge medium">MEDIUM</span>
                        <h3 class="finding-title">S3 Bucket Without Versioning</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> S3 bucket should have versioning enabled
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            1. Explanation: This security issue means that the S3 bucket defined in your Infrastructure as Code (IaC) file does not have versioning enabled. Versioning is a feature in AWS S3 that keeps multiple versions of an object in the same bucket. Without versioning, if an object is deleted or overwritten, you cannot retrieve the previous versions.<br><br>2. Security Concern: Without versioning, accidental deletion or overwriting of objects cannot be undone, leading to potential data loss. Furthermore, if a malicious actor gains access to the bucket, they could delete or modify data without the changes being tracked.<br><br>3. Secure Code Example: Here is how you can enable versioning in your Terraform file:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "bucket-name"<br>  acl    = "private"<br><br>  versioning {<br>    enabled = true<br>  }<br>}<br>```<br>In this code, the `versioning` block with `enabled = true` turns on versioning for the S3 bucket.<br><br>4. Best Practices: Always enable versioning for S3 buckets to maintain a history of object versions. This allows you to recover older versions of an object or even recover objects that have been deleted. Additionally, consider using MFA Delete, which requires multi-factor authentication to delete an object version or change the versioning state of the bucket. This provides an additional layer of security.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div><div id="low-section" class="severity-section"><h2 class="severity-header low">LOW (1)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge low">LOW</span>
                        <h3 class="finding-title">IAM Access Analyzer Not Enabled</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            1. Explanation:<br>This security issue means that the Identity Access Management (IAM) Access Analyzer, a feature provided by AWS, is not enabled in your Infrastructure as a Service (IaaS) code. The IAM Access Analyzer helps monitor and analyze resource permissions to ensure that they are not overly permissive or potentially harmful.<br><br>2. Security Concern:<br>Without the IAM Access Analyzer, it becomes difficult to identify resources that are shared with external entities or have overly permissive access, which could lead to potential unauthorized access or data breaches. It's crucial to have a continuous monitoring system in place to detect any changes that might compromise the security of your resources.<br><br>3. Secure Code Example:<br>To fix this issue, you need to enable the IAM Access Analyzer in your Terraform code. Here is an example:<br><br>```hcl<br>resource "aws_accessanalyzer_analyzer" "example" {<br>  analyzer_name = "example"<br>  type          = "ACCOUNT"<br>}<br>```<br>This code creates an IAM Access Analyzer named "example" for your AWS account.<br><br>4. Best Practices:<br>- Always enable IAM Access Analyzer in your IaC to monitor resource permissions continuously.<br>- Regularly review the findings from the IAM Access Analyzer and take appropriate actions to rectify any overly permissive or insecure permissions.<br>- Implement least privilege principle, i.e., grant only the necessary permissions needed for a user or service to function correctly.<br>- Regularly update and maintain your IaC scripts to ensure they comply with the latest security best practices.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Generated by DriftBuddy - AI-Powered Security Scanner</p>
        </div>
    </body>
    </html>
    