
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DriftBuddy Security Report</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
            }
            
            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }
            
            .header {
                background: white;
                border-radius: 15px;
                padding: 30px;
                margin-bottom: 30px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                text-align: center;
            }
            
            .header h1 {
                color: #2c3e50;
                font-size: 2.5em;
                margin-bottom: 10px;
            }
            
            .header .subtitle {
                color: #7f8c8d;
                font-size: 1.1em;
            }
            
            .summary-section {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }
            
            .summary-card {
                background: white;
                border-radius: 15px;
                padding: 25px;
                text-align: center;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                transition: transform 0.3s ease;
            }
            
            .summary-card:hover {
                transform: translateY(-5px);
            }
            
            .summary-number {
                font-size: 2.5em;
                font-weight: bold;
                margin-bottom: 5px;
            }
            
            .summary-label {
                font-size: 1.1em;
                font-weight: 500;
            }
            
            .summary-card.critical {
                border-left: 5px solid #e74c3c;
            }
            .summary-card.critical .summary-number {
                color: #e74c3c;
            }
            
            .summary-card.high {
                border-left: 5px solid #f39c12;
            }
            .summary-card.high .summary-number {
                color: #f39c12;
            }
            
            .summary-card.medium {
                border-left: 5px solid #3498db;
            }
            .summary-card.medium .summary-number {
                color: #3498db;
            }
            
            .summary-card.low {
                border-left: 5px solid #27ae60;
            }
            .summary-card.low .summary-number {
                color: #27ae60;
            }
            
            .summary-card.info {
                border-left: 5px solid #95a5a6;
            }
            .summary-card.info .summary-number {
                color: #95a5a6;
            }
            
            .toc {
                background: white;
                border-radius: 15px;
                padding: 25px;
                margin-bottom: 30px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                position: sticky;
                top: 20px;
                z-index: 100;
            }
            
            .toc h3 {
                color: #2c3e50;
                margin-bottom: 15px;
            }
            
            .toc ul {
                list-style: none;
            }
            
            .toc li {
                margin-bottom: 8px;
            }
            
            .toc a {
                color: #3498db;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.3s ease;
            }
            
            .toc a:hover {
                color: #2980b9;
            }
            
            .severity-section {
                margin-bottom: 40px;
            }
            
            .severity-header {
                background: white;
                border-radius: 15px 15px 0 0;
                padding: 20px 25px;
                margin-bottom: 0;
                font-size: 1.5em;
                font-weight: 600;
            }
            
            .severity-header.critical {
                background: linear-gradient(135deg, #e74c3c, #c0392b);
                color: white;
            }
            
            .severity-header.high {
                background: linear-gradient(135deg, #f39c12, #e67e22);
                color: white;
            }
            
            .severity-header.medium {
                background: linear-gradient(135deg, #3498db, #2980b9);
                color: white;
            }
            
            .severity-header.low {
                background: linear-gradient(135deg, #27ae60, #229954);
                color: white;
            }
            
            .severity-header.info {
                background: linear-gradient(135deg, #95a5a6, #7f8c8d);
                color: white;
            }
            
            .finding-card {
                background: white;
                border-radius: 0 0 15px 15px;
                margin-bottom: 20px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                overflow: hidden;
            }
            
            .finding-header {
                padding: 20px 25px;
                border-bottom: 1px solid #ecf0f1;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            .severity-badge {
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 0.8em;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            .severity-badge.critical {
                background: #e74c3c;
                color: white;
            }
            
            .severity-badge.high {
                background: #f39c12;
                color: white;
            }
            
            .severity-badge.medium {
                background: #3498db;
                color: white;
            }
            
            .severity-badge.low {
                background: #27ae60;
                color: white;
            }
            
            .severity-badge.info {
                background: #95a5a6;
                color: white;
            }
            
            .finding-title {
                color: #2c3e50;
                font-size: 1.3em;
                margin: 0;
            }
            
            .finding-details {
                padding: 20px 25px;
                background: #f8f9fa;
            }
            
            .detail-item {
                margin-bottom: 10px;
            }
            
            .detail-item:last-child {
                margin-bottom: 0;
            }
            
            .detail-item code {
                background: #e9ecef;
                padding: 2px 6px;
                border-radius: 4px;
                font-family: 'Courier New', monospace;
            }
            
            .finding-explanation {
                padding: 20px 25px;
            }
            
            .finding-explanation h4 {
                color: #2c3e50;
                margin-bottom: 15px;
                font-size: 1.1em;
            }
            
            .explanation-content {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 8px;
                border-left: 4px solid #3498db;
                line-height: 1.7;
            }
            
            .finding-footer {
                padding: 15px 25px;
                background: #f8f9fa;
                border-top: 1px solid #ecf0f1;
            }
            
            .learn-more-btn {
                display: inline-block;
                background: #3498db;
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                text-decoration: none;
                font-weight: 500;
                transition: background 0.3s ease;
            }
            
            .learn-more-btn:hover {
                background: #2980b9;
            }
            
            .footer {
                text-align: center;
                padding: 30px;
                color: white;
                font-size: 0.9em;
            }
            
            @media (max-width: 768px) {
                .container {
                    padding: 10px;
                }
                
                .header h1 {
                    font-size: 2em;
                }
                
                .summary-section {
                    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                }
                
                .finding-header {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 10px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üõ°Ô∏è DriftBuddy Security Report</h1>
                <p class="subtitle">Infrastructure as Code Security Analysis Dashboard</p>
                <p class="subtitle">Generated on 2025-07-25 19:50:35</p>
            </div>
            
            <div class="summary-section">
                
            <div class="summary-card critical">
                <div class="summary-number">1</div>
                <div class="summary-label">CRITICAL</div>
            </div>
            
            <div class="summary-card medium">
                <div class="summary-number">2</div>
                <div class="summary-label">MEDIUM</div>
            </div>
            
            <div class="summary-card low">
                <div class="summary-number">1</div>
                <div class="summary-label">LOW</div>
            </div>
            
            </div>
            
            
        <div class="toc">
            <h3>üìã Table of Contents</h3>
            <ul>
        <li><a href="#critical-section">CRITICAL (1)</a></li><li><a href="#medium-section">MEDIUM (2)</a></li><li><a href="#low-section">LOW (1)</a></li></ul></div>
            
            <div class="findings-content">
                <div id="critical-section" class="severity-section"><h2 class="severity-header critical">CRITICAL (1)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge critical">CRITICAL</span>
                        <h3 class="finding-title">S3 Bucket ACL Allows Read Or Write to All Users</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>3</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> S3 Buckets should not be readable and writable to all users
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            This issue is basically saying that in the Terraform file 'main.tf' in your 'iac_example' directory, there is a major security issue because the settings for your Amazon S3 bucket allows every user to read or write data. This means potentially malicious users can alter, delete, or steal your data, which is a serious security vulnerability.<br><br>In plain English: Your storage box in the cloud (S3 bucket) doesn't have a proper lock on it. Everyone can access, read, and modify what's in the box. We want to change this so only authorized people can access it.<br><br>A secure Terraform code fix would be to configure the bucket's ACL (Access Control List) to private. Here's how you would do this:<br><br>Current code, which is a security risk (do not use):<br>```terraform<br>resource "aws_s3_bucket" "bucket" {<br>  acl    = "public-read-write"<br>  bucket = "my-tf-test-bucket"<br>  ...<br>}<br>```<br><br>Secure code snippet:<br>```terraform<br>resource "aws_s3_bucket" "bucket" {<br>  acl    = "private"<br>  bucket = "my-tf-test-bucket"<br>  ...<br>}<br>```<br>In the secure version, we've replaced `public-read-write` with `private`, which means the bucket is now only accessible by the authorized AWS accounts.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div><div id="medium-section" class="severity-section"><h2 class="severity-header medium">MEDIUM (2)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge medium">MEDIUM</span>
                        <h3 class="finding-title">S3 Bucket Logging Disabled</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            This issue is about a missing configuration in Terraform that should enable logging for an S3 Bucket. Without this configuration, any changes or actions performed on the S3 Bucket won't be logged, and therefore, cannot be tracked. This can make it harder to monitor and secure the bucket because we wouldn't have any records of what was done, by whom, and when.<br><br>The fix consists of just adding a couple of lines to your Terraform file that specify a logging block for your S3 bucket. Here's an example of how you can do this:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "my_bucket"<br><br>  logging {<br>    target_bucket = "logging_bucket"<br>    target_prefix = "my_bucket_logs/"<br>  }<br>}<br>```<br>In the code snippet above, replace `my_bucket` with the name of your S3 bucket and `logging_bucket` with the name of the bucket where you want the logs to be stored. The `target_prefix` option allows you to specify a prefix for the log files, which can be useful for organizing your logs better within the logging bucket.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge medium">MEDIUM</span>
                        <h3 class="finding-title">S3 Bucket Without Versioning</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> S3 bucket should have versioning enabled
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            The issue has been identified in a Terraform file which is a tool for building, changing, and versioning infrastructure safely and efficiently. The configuration in question is setting up an Amazon S3 bucket without enabling versioning. <br><br>S3 bucket versioning is an important feature provided by AWS S3 storage service. It allows you to preserve, retrieve, and restore every version of every object in your bucket. This makes it easier to recover from both unintended user actions and application failures. It's recommended to have this feature enabled to protect your data. <br><br>Here's what the problematic Terraform configuration might look like:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "my-bucket"<br>  acl    = "private"<br>}<br>```<br>Now, let's add versioning configuration to the S3 bucket:<br><br>```hcl<br>resource "aws_s3_bucket" "bucket" {<br>  bucket = "my-bucket"<br>  acl    = "private"<br><br>  versioning {<br>    enabled = true<br>  }<br>}<br>```<br>The 'versioning' block and 'enabled = true' statement ensure that versioning is activated on the S3 bucket. Now, all versions of an object (including all writes and deletes) in the bucket can be preserved.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div><div id="low-section" class="severity-section"><h2 class="severity-header low">LOW (1)</h2>
                <div class="finding-card">
                    <div class="finding-header">
                        <span class="severity-badge low">LOW</span>
                        <h3 class="finding-title">IAM Access Analyzer Not Enabled</h3>
                    </div>
                    <div class="finding-details">
                        <div class="detail-item">
                            <strong>üìÅ File:</strong> <code>./test_data/iac_example/main.tf</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìç Line:</strong> <code>1</code>
                        </div>
                        <div class="detail-item">
                            <strong>üìù Description:</strong> IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions
                        </div>
                    </div>
                    <div class="finding-explanation">
                        <h4>üîç Explanation & Fix</h4>
                        <div class="explanation-content">
                            The issue identified is that IAM Access Analyzer has not been enabled in the mentioned Terraform file. The IAM Access Analyzer is a feature from AWS that helps improve security by identifying resources with potentially unsafe permissions. It monitors resource permissions continuously and provides visibility into which resources can be accessed.<br><br>In other words, the Access Analyzer is not currently being used to monitor for any unsecured permissions in your AWS environment.<br><br>A potential code fix for this issue would be enabling the IAM Access Analyzer. Make sure that you have the necessary permissions to create an analyzer.<br><br>Here is an example of how you could do this with Terraform<br><br>```hcl<br>resource "aws_accessanalyzer_analyzer" "example" {<br>  analyzer_name = "example"<br>  type          = "ACCOUNT"<br>  tags = {<br>    Name = "example"<br>    Environment = "Test"<br>  }<br>}<br>```<br><br>In this example, an IAM Access Analyzer named "example" is created. The "type" is set to "ACCOUNT", meaning that it will monitor account-based permissions. The tags just describe the analyzer.<br><br>Remember to replace the placeholders ("example" and "Test") with suitable names specific to your application.<br><br>Also, depending on how your Terraform is set up, you may need to run `terraform init` to ensure your AWS plugin is updated, and `terraform apply` to apply the changes to your environment.
                        </div>
                    </div>
                    <div class="finding-footer">
                        <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer" target="_blank" class="learn-more-btn">üìö Learn More</a>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Generated by DriftBuddy - AI-Powered Security Scanner</p>
        </div>
    </body>
    </html>
    